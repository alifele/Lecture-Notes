\chapter{Introduction}




\section{Some Random Calculus}
In this section I will cover some basic calculus concepts which will be used in the later chapters. I start with the Divergence theorem

\begin{theorem}[Divergence theorem]
	Let $F:\R^3 \to \R^3$ be a vector field defined on $\Omega \subset \R$. Then
	\[ \int_{\Omega}\div{F}dV = \int_{\partial \Omega} F \cdot d\vec{s} \]
\end{theorem}

By letting $F = \phi\nabla\psi$, the theorem above helps us to define a similar notion to integration by parts in higher dimensions. To see this, first observe that
\[ \div{\phi\nabla\psi} = \nabla\phi\cdot\nabla\psi + \phi\underbrace{\nabla^2\psi}_{\div{(\nabla\psi)}}.  \]
You can check this by simply writing the equation term by term. Then the divergence theorem for $\phi\nabla\psi$ will be
\[ \int_\Omega \div{(\phi\nabla\psi)}dV = \int_\Omega (\nabla\phi\cdot\nabla\psi + \phi \nabla^2\phi) dV = \int_{\partial\Omega}\phi\nabla\psi\cdot d\vec{s}. \]
By rearranging the terms we will have
\[ \int_\Omega \nabla\phi\cdot\nabla\psi dV = \int_{\partial\Omega}\psi\nabla\phi \cdot d\vec{s} - \int_\Omega \phi \div{(\nabla\phi)} dV \].
To make this identity more similar to the integration by parts in 1D, let $F=\nabla\psi$. Then we will have the following theorem
\begin{theorem}[Integration by parts in higher dimensions]
	Let $F:\R^3\to\R^3$ be a vector field, and $\phi:\R^3\to\R$ an scalar function, both defined on $\Omega$. Then 
	\[\int_\Omega (F\cdot \nabla\phi)dV = \int_{\partial\Omega}\phi F \cdot d\vec{s} - \int_{\Omega}\phi \div{F} dV.  \]
\end{theorem}


By applying the divergence theorem on $F = \psi\nabla\phi - \phi\nabla\psi$, and using the identity $\div{(\psi\nabla\phi) = \nabla\psi\cdot\nabla\phi - \psi\nabla^2\psi}$, we can derive the Green's second identity.
\begin{theorem}[Green's second identity]
	Let $\phi,\psi: \R^3 \to \R$ defined on some region $\Omega$. Then 
	\[ \int_\Omega (\psi\nabla^2\phi - \phi\nabla^2\psi)dV = \int_{\partial\Omega}(\psi\nabla\phi-\phi\nabla\psi)\cdot d\vec{s}. \]
\end{theorem}


\section{Some Random Linear Algebra}

\subsubsection{Self-adjoint matrices}
\begin{definition}[Self adjoint matrix]
	A matrix $M: V \to V$ is self adjoint if and only if and only if
	\[ \dotProd{v}{Mu} = \dotProd{Mv}{u} \]
	for $v,u \in V$. In words, $M = M^* = (\conj{M})^T$.
\end{definition}

\begin{proposition}
	The set of all basis sets for a vector space $V$ is identical with the set of all non-singular and self-adjoint operators $M: V\to V$ up to matrix similarity
\end{proposition}
\begin{proof}
	This is not a formal proof, but an informal discussion of the idea. Every self-adjoint matrix has a set of orthogonal eigenvectors that can be considered as a basis. 
\end{proof}




\section{Classification of The Second Order PDEs }

Partial differential equations relate the partial derivatives of a function to each other. For example $f$ can be a function of spacial coordinates (like $x,y,z$ in the case of Cartesian coordinates), dynamical variable (like time), or any other kind of variables (like the space of genotypes g). For example suppose that $ \Phi(x,y) $ represents the electric potential of a point charge. Such function should satisfy the Laplace equation:

\[	 \partial_{xx} \Phi + \partial_{yy} \Phi = 0.	\]
Note that the symbols $ \partial_{xx} $ and $ \partial_{yy} $ are short symbols for $ \frac{\partial^2}{\partial x^2} $ and $ \frac{\partial^2}{\partial y^2} $ respectively.

\begin{definition}{Order of PDE}
	The order of a PDE is the highest derivative that occurs in the equation. 
\end{definition}

Based on the definition above, the Laplace equation is a second order partial differential equation. 

There are three categories of the second order PDEs that every other type of a second order PDE can be converted to one of these kinds. The most general type of a second order PDE can be written as:

\begin{equation}
	A \partial_{xx} u + B \partial_{xy} u + C \partial_{yy} u + D \partial_{x} u + E \partial_{y} u + F u = k
	\label{equ:GeneralSecondOrderPDE}
\end{equation}

In which the coefficients are all a function of $x,y$ (but not $ u $ in which case the PDE will be nonlinearx). Equation \ref{equ:GeneralSecondOrderPDE} can be summarized in a more compact form using the derivative operator $ \operatorname{L} $: 

\[	 \operatorname{L} u = 0,	\]

in which:

\[  \operatorname{L} = A \partial_{xx} + B \partial_{xy} + C \partial_{yy} + D \partial_{x} + E \partial_{y} + F \].

Because of the similarities of the equation \ref{equ:GeneralSecondOrderPDE} with the generic quadratic equation describing the conic sections, we call each class of second order PDEs with its corresponding conic section. The generic equation describing the conic sections is:

\begin{equation}
	A x^2 + B x y + C y^2 + D x + E y + K = 0.
	\label{equ:ConicSections}
\end{equation}


All of the conic sections (ellipse, parabola, hyperbola) can be described with the equation \ref{equ:ConicSections} which is determined with the discriminant $ \Delta = B^2 - 4 A C $. for $ \Delta=0 $, $ \Delta > 0 $, and $ \Delta < 0 $ the conic section will be \textbf{parabolic}, \textbf{hyperbolic}, and \textbf{elliptic} respectively. Table \ref{tab:PDE-types} summarizes special categories of the linear second order PDEs that frequently occur in physical applications. \newline


\begin{table}[]
	\centering
	\resizebox{\textwidth}{!}{%
		\begin{tabular}{|c|c|c|c|c|}
			\hline
			PDE                     & Analogous conic sec. & $\Delta$     & Class      & Application               \\ \hline
			$ u_t = u_{xx}$         & $T = x^2$           & 0            & parabolioc & Diffusion - Heat Equation \\ \hline
			$ u_{tt} = u_{xx} $     & $T^2 = x^2$         & $\Delta > 0$ & Hyperbolic & Wave Equation             \\ \hline
			$ u_{xx} + u_{yy} = 0 $ & $x^2 + y^2 = 0$ & \multirow{2}{*}{$\Delta < 0$} & \multirow{2}{*}{Elliptic} & Laplace \\ \cline{1-2} \cline{5-5} 
			$ u_{xx} + u_{yy} = c $ & $x^2 + y^2 = k$     &              &            & Poisson                   \\ \hline
		\end{tabular}%
	}
	\caption{A summary of the three class of second order linear PDE.}
	\label{tab:PDE-types}
\end{table}


\subsection{Intuitive Derivation of the Second Order PDEs}
The three classes of the second order linear PDEs in table \ref{tab:PDE-types} can be derived intuitively using the continuity law (conservation law) and the constitutive law that is determined by the nature of the problem which is the subject of the following sections. 
 
\subsubsection{Continuity Equation or Conservation Laws}
The most important part of deriving the PDE equations is the continuity law or conservation law. This fact is imposed because of our common sense about nature. Suppose that we want to study the concentration of of a red ink in a infinitesimal cube. The continuity equation, in simple terms, state that the change of the concentration of the ink inside the infinitesimal cube is equal to the ink that has entered the cube from outside from its boundaries (we are assuming no source or sink of ink inside the cube). For instance, consider the infinitesimal box in figure \ref{fig:infbox}. The change of the concentration of the ink inside the cube is $\frac{\partial c}{\partial t}$. Because we know that there are no sources or sinks of ink inside the cube, then the change in the concentration is equal to the amount that comes in and goes out from the boundaries of the box. To put this in numbers, we introduce the important vector quantity \emph{flux} $ \Phi $. Flux is the amount of particles flow per unit area per unit time (see figure \ref{fig_fluxCrossSection}).

\input{Images/fig_fluxCrossSection.tex}
\input{Sections/fig_infcube.tex}


\newpage

Let's get back to the infinitesimal cube in figure \ref{fig:infbox} and derive the continuity equation. We can start we tracking the net change in the number of particles inside the cube due to the flux in x direction:

\begin{align*}
	-\frac{dN_x}{dt} &= \Phi_x(x,y,z) . (-dz dy) + \Phi_x(x +dx, y,z) . (dzdy) \\
	 				&= (\Phi_x(x+dx,y,z)-\Phi_x(x,y,z))dydz 
\end{align*}

Note that the negative sign in the LHS of the equation above is simply to match the meaning of the two sides of the equations. For instance, if the RHS of the equation above is positive, it means that the net change of the number of particles in the box in negative (meaning that particles are leaving the box) which is equivalent to $ -\frac{dN}{dt} $. Similarly in the y and z direction:

\begin{align*}
	-\frac{dN_y}{dt} &= (\Phi_y(x,y+dy,z)-\Phi_y(x,y,z)) dx dz \\
	-\frac{dN_z}{dt} &= (\Phi_z(x,y,z+dz) - \Phi_z(x,y,z)) dx dy
\end{align*}

So the net change in the number of particle in the box per $dt$ will be:

\begin{align*}
	-\frac{dN}{dt} &= - (\frac{dN_x}{dt} + \frac{dN_y}{dt} + \frac{dN_z}{dt}) \\
	&= (\Phi_x(x+dx,y,z)-\Phi_x(x,y,z))dydz + \\
	&\, (\Phi_y(x,y+dy,z)-\Phi_y(x,y,z)) dx dz + \\
	&\, (\Phi_z(x,y,z+dz) - \Phi_z(x,y,z)) dx dy
\end{align*}


By dividing the both sides of the above equation by the volume of the cube $ dV = dx dy dz $ we can write:

\begin{equation*}
	\frac{dc}{dt} = - (\partial_{x}\Phi_x + \partial_{y}\Phi_y + \partial_{z}\Phi_z) = -\mathbf{\nabla} . \Phi
\end{equation*}

In which $c = N/V$ is the concentration, $ \nabla $ is the divergence operator, and $ \Phi $ is the flux. 

\begin{definition}{Continuity Equation}
	The following important relation is known as the continuity equation(or conservation law):
	
	\begin{equation}
			\frac{dc}{dt} + \mathbf{\nabla} . \Phi = 0
	\end{equation}

	in which $\Phi$ is the flux, $c$ is the concentration, and $ \nabla $ is the divergence operator.
\end{definition}


\subsubsection{Conservation Law for Momentum}
will be used to derive the wave equation


\subsection{Constitutive Laws: Advection, Diffusion and Wave Equation}

Having the continuity equation in hand makes the derivation PDEs very straight forward. We only need to insert the constitutive laws (which are enforced by the nature of the problem) in the continuity equations derived in the section above.


\begin{itemize}
	\item Fick's Law $\rightarrow$ Constitutive law for diffusion 
	\item Hook's law $\rightarrow$ Constitutive law for the wave equation
\end{itemize}



