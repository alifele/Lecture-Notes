\chapter{Finite Element Methods}

In this chapter, we will cover the basics of the theory of finite element methods. 

\section{Basics and Notations}
For convenience in notation for partial derivatives, we introduce the following notation using the multi-index.

\begin{definition}[Definition of multi-index]
	Let $ n \in \N $. Then the following $m$-tuple
	\[ \alpha = (\alpha_1,\alpha_2,\cdots,\alpha_n) \in \R^n \]
	is called a multi-index, with its length defined as
	\[ \abs{\alpha} = \alpha_1 + \alpha_2 + \cdots + \alpha_n \]
\end{definition}

Now we can have a very compact notation for the partial derivatives of a function using the notion of multi-index.

\begin{definition}[Partial derivatives with multi-index]
	Let $ \Omega \subset \R^n $, and $ f:\Omega \to \R $ be $ m $-times continuously differentiable. Then we have
	\[ D^\alpha f = \big( \frac{\partial}{\partial x_1} \big)^{\alpha_1} \big( \frac{\partial}{\partial x_2} \big)^{\alpha_2}  \cdots \big( \frac{\partial}{\partial x_n} \big)^{\alpha_n}f = \frac{\partial^{\abs{\alpha}}}{\partial x_1^{\alpha_1}\ \partial x_2^{\alpha_2}\ \cdots \partial x_n^{\alpha_n}} f. \]
	Note that since the function is $ m $-times differentiable, then the above definition is defined for $ \abs{\alpha} < m $.
\end{definition}

\begin{example}
	Suppose that $ n=3 $, and $ \Omega \subset \R^3 $. Define $ f: \Omega \to \R $. Then we have
	\begin{align*}
		\sum_{\abs{\alpha}=3} D^{\alpha} f &=  (\frac{\partial^3}{\partial x_1^{3}} + \frac{\partial^3}{\partial x_2^{3}} + \frac{\partial^3}{\partial x_3^{3}} + \frac{\partial^3}{\partial x_1^{2}\partial x_2^{1}} + \frac{\partial^3}{\partial x_1^{1}\partial x_2^{2}} + \frac{\partial^3}{\partial x_2^{1}\partial x_3^{2}} + \frac{\partial^3}{\partial x_2^{2}\partial x_3^{1}} \\
		&+ \frac{\partial^3}{\partial x_1^{1}\partial x_3^{2}} + \frac{\partial^3}{\partial x_1^{2}\partial x_3^{1}} + \frac{\partial^3}{\partial x_1^{1}\partial x_2^{1}\partial x_3^{1}})f.
	\end{align*}
	This example shows how we can simply avoid writing 10 terms using a appropriately designed notation.
\end{example}

\subsection{Space of Continuously Differentiable Functions}

Now we review some basic definitions about the function spaces.
\begin{definition}[Space of continuous functions]
	Let $ \Omega \subset \R^n $, an open region. The space of all continuous functions defined on this region is denoted by $ \mathscr{C}^0(\Omega) $ and defined as follows
	\[ \mathscr{C}^0(\Omega) = \Set{f:\Omega\to \R \ :\ f \text{ is continuous}}. \]
	Also, let $ \mathscr{C}^0(\closure{\Omega})$ denote the set of all functions $ f\in \mathscr{C}^0(\closure{\Omega}) $ that can be extended from $ \Omega $ to a continuous function defined on $ \closure{\Omega} $.\\
\end{definition}
\begin{remark}
	Note that since $ \closure{\Omega} $ compact, then all of the functions in $ \mathscr{C}^0(\closure{\Omega}) $ are bounded. That is true because all the continuous functions defined on a compact set are uniformally continuous, thus bounded.
\end{remark}

\begin{example}
	Let $ \Omega = (0,1) $. Then $ f: \Omega \to \R $, where $ f(x) = 1/x $ is in $ \mathscr{C}^0(\Omega) $ but not in $ \mathscr{C}^0(\closure{\Omega}) $. I.e.
	\[ f \in \mathscr{C}^0(\Omega), \qquad f\notin \mathscr{C}^0(\closure{\Omega}). \]
\end{example}


\begin{proposition}[Vector space structure of the space of continuous functions]
	Let $ \Omega \subset \R^n $. The space $ \mathscr{C}^0(\Omega) $ is a vector space. A suitable norm for this space is defined as follows
	\[ \norm{f} = \norm{f}_\infty = \sup_{x\in \Omega}\abs{f(X)},\]
	where $ f \in \mathscr{C}^0(\Omega) $.
\end{proposition}

\begin{lemma}
	Let $ f \in \mathscr{C}^0(\closure{\Omega}) $. Then
	\[ \norm{f}_\infty = \sup_{x\in \Omega}\abs{f(x)} = \max_{x\in \Omega}\abs{f(x)}. \]
\end{lemma}
\begin{proof}
	A continuous function defined on a compact set attains its maximum and minimum in the set. 
\end{proof}
Now we can define the space of $ k $-times continuously differentiable functions. 

\begin{definition}[The space of k-times continuously differentiable functions]
	Let $ \Omega \subset \R^n $. Then we define the space of $ k $-times continuously differentiable functions defined on $ \Omega $ as 
	\[ \mathscr{C}^k(\Omega) = \Set{f \in \mathscr{C}^0(\Omega)\ :\ D^\alpha f \in \mathscr{C}^0(\Omega) \quad \text{for}\ \abs{\alpha} \leq k   }. \]
\end{definition}

Similar to the space of all continuous functions, the space of all $ k $-times continuously differentiable functions also has a vector space structure as reflected by the following lemma.

\begin{lemma}
	Let $ \Omega \subset \R^n $. Then $ \mathscr{C}^k(\Omega) $ is a vector space. The following norm is a useful norm for this space. 
	\[  \norm{f}_{\mathscr{C}^k} = \sum_{\abs{\alpha} \leq k} \norm{D^\alpha f}_\infty. \]
\end{lemma}
\begin{remark}
	We can of course come up with many other norms, some of them as good as the norm defined above. 
	\[ \norm{f}_{\mathscr{C}^k} = \big(\sum_{\abs{\alpha} \leq k} \norm{D^\alpha f}^p_\infty \big)^{1/p}. \]
	And if we let $ p \to \infty $ then 
	\[ \norm{f}_{\mathscr{C}^k} = \sup_{\abs{\alpha}\leq k} \norm{D^\alpha f}_\infty = \max_{\abs{\alpha}\leq k} \norm{D^\alpha f}_\infty. \]
	Note that we say these norms are good in a sense that it makes the space of interest a complete normed vector space, i.e. a Banach space. 
\end{remark}

\begin{observation}
	Considering the remark above, $ \mathscr{C}^k(\Omega) $ kind of resembles the Euclidean space $ \R^n $ in the sense of extending a norm from $ \R $ to $ \R^k $.
\end{observation}

The following example demonstrates all of these definitions in a more concrete example.

\begin{example}
	Let $ \Omega \subset \R^2 $, open and bounded. The the space of all one time continuously differentiable functions is
	\[ \mathscr{C}^1(\Omega) = \Set{f\in \mathscr{C}^0(\Omega)\ :\ \partial_{x}f \in \mathscr{C}^0(\Omega)\ \text{and}\ \partial_y f \in \mathscr{C}^0(\Omega)}. \]
	And the corresponding suitable norm for this space is
	\[ \norm{f}_{\mathscr{C}^k} = \norm{f}_\infty  + \norm{\frac{\partial f}{\partial x}}_\infty + \norm{\frac{\partial f}{\partial y}}_\infty. \]
\end{example}

\subsection{Space of Lebesgue Integrable Functions}
Here, we define some spaces of functions that are basically characterizing the growth and decay rate of functions. The following definition makes this more clear. 
\begin{definition}
	Let $ \Omega \subset \R^n $, and let $ p\geq 1 $ be a real number. Then we define
	\[ \tilde{L}_p(\Omega) = \Set{f:\Omega\to\R\ :\ \big(\int_\Omega \abs{f(x)}^p dx \big)^{1/p} < \infty} \]
\end{definition}

The following proposition is very crucial for our up coming discussions.
\begin{proposition}
	Let $ \Omega \subset \R^n $, and $ p\geq 1 $. Then $ (\tilde{L}_p(\Omega)/\!\!\sim, \norm{\cdot}_{L_p}) $ is a normed vector space, where $ \sim $ is a equivalence relation defined on the set $ L_p(\Omega) $ identifying the functions that are equal almost everywhere. Further more the norm is defined as
	\[ \norm{f}_{L_p} = \big(\int_\Omega \abs{f(x)}^p dx\big)^{1/p}.\]
	We denote 
	\[  L_p(\Omega) :=  \tilde{L}_p(\Omega)/\!\!\sim \]
\end{proposition}
\begin{remark}
	There are some notes to emphasis here. \\
	1. We defined the $ L_p(\Omega) $ to be the quotient set $ \tilde{L}_p(\Omega)/\!\!\sim  $. The reason for that is because the $ \norm{\cdot}_{L^p} $, when defined on $\tilde{L}_p$ is no longer a norm, as it is not positive definite. I.e., the norm of a function in $ \tilde{L_p} $ can be zero, while the function is not identically zero, but is zero almost everywhere, i.e. on a set of measure zero. That is why we need to identify the functions that are equal almost everywhere. \\
	2. To check to see see if the norm defined as above satisfies the properties of norm, we can use the Minkowski inequality to show that it satisfies the triangle inequality. However, for the spacial case $ p=2 $ we can show this by using the Cauchy-Schwartz inequality. Yes! we can define inner product when $ p=2 $ and utilize the properties of Cauchy Schwartz inequality.
\end{remark}

\begin{proposition}[H\"{o}lder's inequality]
	Let $ u\in L_p(\Omega) $ and $ v \in L_q(\Omega) $ where $ 1/p + 1/q = 1. $
	Then we have
	\[ \norm{uv}_{L^1} = \norm{u}_{L^p} \norm{v}_{L^q} \]
\end{proposition}

The following theorem is among the central theorems for this chapter. 

\begin{theorem}[$ L_p $ space is a Banach space]
	Let $ \Omega\subset \R$. Then the space $ L_p(\Omega) $ (where $ p \geq 1 $) is a complete normed vector space, i.e. Banach space. 
\end{theorem}

When we let $ p\to \infty $, we will get the space $ L_\infty(\Omega) $, another interesting $ L_p  $ space that has characterizations quite similar to $ \mathscr{C}^0 $. 

\begin{proposition}[$ L_\infty $ space.]
	Consider the space $ L_p(\Omega) $. If we let $ p\to \infty $, we will get the space $ L_\infty(\Omega) $ that is defined as
	\[ L_\infty(p) = \Set{f: \Omega\to \R\ :\ \text{$ f $ is finite bounded almost everywhere}}, \]
	and the corresponding norm for this space is
	\[ \norm{f}_{L_\infty} = \operatorname{ess.sup}_{x\in \Omega} \abs{f(x)}. \]
	This space is also a Banach space. 
\end{proposition}


For $ L_p(\Omega) $ when $ p=2 $ then something interesting happens, and the space $ L_2(\Omega) $ has so many useful features that is the horse power of the modern PDE analysis, among many other applications. 

\begin{proposition}[$ L^2 $ is a Hilbert space]
	$ L_2(\Omega) $ is a Hilbert space (a Banach space equipped with an inner product) with the following inner product
	\[ (u,v) = \int_\Omega \abs{u(x)v(x)} dx. \]
	Clearly
	\[ \norm{u}_{L_2} = \sqrt{(u,u)}. \]
\end{proposition}
Since the inner product defined on $ L_2(\Omega) $ an actual inner product (look at this tautology!), then it satisfies the Cauchy-Schwartz inequality.

\begin{proposition}
	Consider the Hilbert space $ L_2(\Omega) $. Then for all $ u,v \in L_2(\Omega) $ we have
	\[ \abs{(u,v)} \leq \norm{u}_{L^2} \norm{v}_{L^2} \]
\end{proposition} 

\begin{remark}
	Among many other applications, we can use the Cauchy-Schwartz inequality to show that the $ L_2 $ norm satisfies the triangle inequality. To show this, we begin with
	\[  \norm{u+v}_{L_2}^2 = (u+v,u+v) = \norm{u}^2_{L_2} + \norm{v}^2_{L_2} + 2(u,v) \leq (\norm{u}^2_{L_2} + \norm{v}^2_{L_2})^2 . \]
	Then this implies
	\[ \norm{u+v}_{L_2} \leq \norm{u}_{L_2} + \norm{v}_{L_2}. \]
\end{remark}

\subsection{Sobolev Spaces}